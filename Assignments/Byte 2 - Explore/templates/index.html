<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="favicon.ico">
    <title>Explore Byte Tutorial</title>
    
    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap theme -->
    <link href="css/bootstrap-theme.min.css" rel="stylesheet">
    <!-- Custom styles for this project -->
    <link href="css/explore.css" rel="stylesheet">
  </head>
  
  <body role="document">
    
    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container" >
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="about">About This Data Set</a></li>
	    <li><a href="quality">Data Quality</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
    
    <div class="container theme-showcase" role="main">
      
      <!-- Main jumbotron for a primary marketing message or call to action -->
      <div class="jumbotron">
	<h1>Interactive Data Science Project Exploratory Analysis Byte Example</h1>
        <p>This is the Exploratory Analysis Byte of the Interactive Data Science class.</p>
        <p> Using the English Premier League data set below, I have attempted to answer the question: How are Premier League Teams related to each other?
        To visualize this I have drawn a network diagram with all the premier league teams since 2006 and weighted the relationships with their home goals scored. </p>
        <p> The SQL query is not used in the visualizaiton, however it is used to highlight the 50 highest scoring matches in the last 12 years in order. </p>
      </div>
      
      
      <div class="row">
      <center>
      	<iframe width="700" height="400" scrolling="no" frameborder="no" src="https://fusiontables.google.com/embedviz?containerId=googft-gviz-canvas&amp;viz=GVIZ&amp;t=GRAPH&amp;gc=false&amp;gd=false&amp;sdb=1&amp;rmax=100000&amp;q=select+col0%2C+col1%2C+col2+from+1p9w2XmvtTaMKcLGoqNXCXuWax94_vE21Pdn2fjRY&amp;qrs=+where+col0+%3E%3D+&amp;qre=+and+col0+%3C%3D+&amp;qe=&amp;uiversion=2&amp;state=%7B%22ps%22%3A%221_j_-8_16_i_a_5_g_w_3_2_s_-12_1_i_-f_f_g_17_c_2_-r_4_-8_-a_6_p_o_k_4_q_3_14_-k_o_-c_a_n_-m_o_h_17_o_u_-s_-5_9_1j_-9_7_1i_a_w_-f_-14_e_15_15_p_9_-17_y_-19_-3_t_-x_a_5_-l_-r_8_1w_0_z_-11_-j_q_-14_p_b_1m_m_r_y_1l_v_-p_16_a_1l_-s_m_1k_14_10_-10_-10_l_24_-e_s_25_9_d_22_m_11_-1u_-3_x_-1i_-m_12_-m_-1q_0_2h_-8_%22%2C%22cx%22%3A0%2C%22cy%22%3A0%2C%22sw%22%3A839.7386821062663%2C%22sh%22%3A417.973768407295%2C%22z%22%3A1.480726180006612%7D&amp;gco_forceIFrame=true&amp;gco_hasLabelsColumn=true&amp;width=700&amp;height=400"></iframe>
      	<p> Network Graph showing relationship between teams of the EPL. <br/>The size of the bubble demonstrates total home goals scored by that team, an indicator of the team's quality.</p>
      	</center>
      </div>
      
      <div class="page-header">
	
      </div> <!-- /page-header -->
    </div> <!-- /container -->
	<center>
    <div class="button-toolbar" role="toolbar" id="headers" name="headers">
      {% for column in columns %}
      <button type="button" class = "btn-space btn btn-info" id="{{column}}" onclick="updateTable('{{column}}')">{{column}}</button>
      {% endfor %}
    </div>
    </center>
    
    <!--
    <div id="animals"><table id="data" class="table table-striped table-hover">
	<thead class ="thead-inverse">
	  <tr id="cols">
	  </tr>
	</thead>
	<tbody id="rows"> 
	</tbody>
    </table></div>
  -->
  
  <div class="table-responsive">
    <table class="table table-striped table-hover">
      <thead class="thead-inverse">
       <tr id="cols">
    {% for item in columns %}
             <th>{{ item }}</th>
    {% endfor %}
         </tr>
        </thead>
        <tbody id="rows">
    {% for row in rows %}
         <tr>
      {% for datum in row %}
                <td>{{ datum }} </td>
      {% endfor %}
         </tr>
    {% endfor %}
        </tbody>
     </table>
  </div>
  
  
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/jquery-1.11.3.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script>
	function updateTable(str) {
		console.log("in updateTable");
		console.log(str);

	    // error checking: ignore buttons that don't have a title!
		if (str == "") {
			return;
		}

	    // find the actual button in this document's HTML
		button = document.getElementById(str);
		// for debugging, write its name to the console
		console.log(button.className);
		// check if it is disabled (btn-info)
		if (button.className.includes("btn-info")) {
			// and enable it (btn-primary)
			button.className = "btn btn-space btn-primary";
		} else {
			// otherwise disable it (btn-info)
			button.className = "btn btn-space btn-info";
		}

		// now get all the buttons
		buttons = document.getElementById("headers").children;
		// and collect their names in cols
		cols = [];
		// loop through them
		for (button in buttons) {
			// grab the id (the name we need is there)
			id = buttons[button].id;
			// make sure it isn't null
			if (buttons[button].id != null) {
				// and that the button is selected 
				var isPrimary = buttons[button].className.includes("btn-primary");
				if (isPrimary && (cols.indexOf(id) == -1)) {
					// if so, add it to our array
					cols.push(id);
				}
			}
		}
					
		$.ajax({
			url: '/_update_table',
			dataType: 'json',
			contentType: 'application/json',
			data: JSON.stringify({'cols' : cols}),
			type: 'POST',
			success: function (res, status) {
				console.log("successrunning");
				console.log(res["content"]);
				console.log(res["headers"]);
				var cols = res["headers"];
				var rows = res["content"];

				// get the table, columns and rows
				table = document.getElementById("data");
				headers = document.getElementById("cols");
				body = document.getElementById("rows");

				// delete current contents
				headers.innerHTML='';
				body.innerHTML = '';

				// and put the new information in the table
				for (col in cols) {
					cell = document.createElement("th");
					cell.innerHTML = cols[col];
					headers.appendChild(cell);
				}
				for (row in rows) {
					tr = document.createElement("tr");
					for (item in rows[row]) {
						td = document.createElement("td");
						td.innerHTML = rows[row][item];
						tr.appendChild(td);
					}
					body.appendChild(tr);
				}
			},
			error: function(res, status) {
				// On Error
				alert('error');
			}
		});
	}
				
				   
				   
</script>
</body>
</html>
